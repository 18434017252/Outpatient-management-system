{% extends "base.html" %}

{% block title %}药品管理{% endblock %}

{% block content %}
<div class="card">
    <h2 class="card-title">药品管理</h2>
    
    <h3>新增药品</h3>
    <form method="POST">
        <input type="hidden" name="action" value="create">
        <div class="form-group">
            <label for="name">药品名称</label>
            <input type="text" name="name" id="name" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="quantity">库存</label>
            <input type="number" name="quantity" id="quantity" class="form-control" min="0" required>
        </div>
        <div class="form-group">
            <label for="price">价格</label>
            <input type="number" name="price" id="price" class="form-control" step="0.01" min="0" required>
        </div>
        <button type="submit" class="btn btn-success">新增</button>
    </form>
    
    <h3 style="margin-top: 2rem;">修改药品信息</h3>
    <form method="POST">
        <input type="hidden" name="action" value="update">
        <div class="form-group">
            <label for="drug_id">药品</label>
            <select name="drug_id" id="drug_id" class="form-control" required>
                {% for drug in drugs %}
                <option value="{{ drug.drug_id }}">{{ drug.drug_id }} - {{ drug.drug_name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="update_type">修改类型</label>
            <select name="update_type" id="update_type" class="form-control" required>
                <option value="price">价格</option>
                <option value="quantity">库存</option>
            </select>
        </div>
        <div class="form-group">
            <label for="update_value">新值</label>
            <input type="text" name="update_value" id="update_value" class="form-control" required>
        </div>
        <button type="submit" class="btn btn-primary">修改</button>
    </form>
    
    <h3 style="margin-top: 2rem;">药品列表</h3>
    {% if drugs %}
    <table>
        <thead>
            <tr>
                <th>药品编号</th>
                <th>药品名称</th>
                <th>库存数量</th>
                <th>单价</th>
                <th>创建时间</th>
            </tr>
        </thead>
        <tbody>
            {% for drug in drugs %}
            <tr>
                <td>{{ drug.drug_id }}</td>
                <td>{{ drug.drug_name }}</td>
                <td>{{ drug.stored_quantity }}</td>
                <td>¥{{ drug.drug_price }}</td>
                <td>{{ drug.created_at }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>暂无药品</p>
    {% endif %}
    
    <div style="margin-top: 2rem;">
        <a href="{{ url_for('admin_home') }}" class="btn btn-secondary">返回</a>
    </div>
</div>
{% endblock %}
