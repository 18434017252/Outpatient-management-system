{% extends "base.html" %}

{% block title %}医生管理{% endblock %}

{% block content %}
<div class="card">
    <h2 class="card-title">医生管理</h2>
    
    <h3>新增医生</h3>
    <form method="POST">
        <input type="hidden" name="action" value="create">
        <div class="form-group">
            <label for="name">姓名</label>
            <input type="text" name="name" id="name" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="gender">性别</label>
            <select name="gender" id="gender" class="form-control" required>
                <option value="男">男</option>
                <option value="女">女</option>
            </select>
        </div>
        <div class="form-group">
            <label for="phone_number">手机号</label>
            <input type="text" name="phone_number" id="phone_number" class="form-control" required>
        </div>
        <button type="submit" class="btn btn-success">新增</button>
    </form>
    
    <h3 style="margin-top: 2rem;">修改医生科室</h3>
    <form method="POST">
        <input type="hidden" name="action" value="set_department">
        <div class="form-group">
            <label for="doctor_id_dept">医生工号</label>
            <select name="doctor_id" id="doctor_id_dept" class="form-control" required>
                {% for doc in doctors %}
                <option value="{{ doc.doctor_id }}">{{ doc.doctor_id }} - {{ doc.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="department_id">科室</label>
            <select name="department_id" id="department_id" class="form-control" required>
                {% for dept in departments %}
                <option value="{{ dept.department_id }}">{{ dept.department_name }}</option>
                {% endfor %}
            </select>
        </div>
        <button type="submit" class="btn btn-primary">修改</button>
    </form>
    
    <h3 style="margin-top: 2rem;">修改医生职称</h3>
    <form method="POST">
        <input type="hidden" name="action" value="set_position">
        <div class="form-group">
            <label for="doctor_id_pos">医生工号</label>
            <select name="doctor_id" id="doctor_id_pos" class="form-control" required>
                {% for doc in doctors %}
                <option value="{{ doc.doctor_id }}">{{ doc.doctor_id }} - {{ doc.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="position">职称</label>
            <input type="text" name="position" id="position" class="form-control" required>
        </div>
        <button type="submit" class="btn btn-primary">修改</button>
    </form>
    
    <h3 style="margin-top: 2rem;">医生列表</h3>
    {% if doctors %}
    <table>
        <thead>
            <tr>
                <th>工号</th>
                <th>姓名</th>
                <th>性别</th>
                <th>手机号</th>
                <th>职称</th>
                <th>科室编号</th>
            </tr>
        </thead>
        <tbody>
            {% for doc in doctors %}
            <tr>
                <td>{{ doc.doctor_id }}</td>
                <td>{{ doc.name }}</td>
                <td>{{ doc.gender }}</td>
                <td>{{ doc.phone_number }}</td>
                <td>{{ doc.position or '未设置' }}</td>
                <td>{{ doc.department_id or '未分配' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>暂无医生</p>
    {% endif %}
    
    <div style="margin-top: 2rem;">
        <a href="{{ url_for('admin_home') }}" class="btn btn-secondary">返回</a>
    </div>
</div>
{% endblock %}
